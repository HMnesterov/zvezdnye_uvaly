(function(){"use strict";var e={426:function(e,t,i){var c=i(5130),o=i(6768);function s(e,t,i,c,s,r){const n=(0,o.g2)("HelloWorld");return(0,o.uX)(),(0,o.Wv)(n,{msg:"Welcome to Your Vue.js App"})}var r=i(4232),n=i.p+"img/photo.75aabe2c.png";const l=e=>((0,o.Qi)("data-v-7330665a"),e=e(),(0,o.jt)(),e),a={class:"wrapper"},h={class:"hakaton"},d={class:"left"},u=l((()=>(0,o.Lk)("img",{alt:"ЛЕС",src:n},null,-1))),p={class:"coords"},v=["onClick"],f={class:"hint"},k={class:"name"},m={key:0,class:"owner"},g={class:"menu"},w={class:"menu-list"},C={key:0,class:"menu-list-item"},x={class:"right"},y={class:"select_wrapper"},b=["onClick"],L={class:"name select-item-flex"},_=l((()=>(0,o.Lk)("div",{class:"title"}," Имя: ",-1))),E={class:"text"},D={class:"price select-item-flex"},T=l((()=>(0,o.Lk)("div",{class:"title"}," Цена: ",-1))),X={class:"text"},O={key:0,class:"owner select-item-flex"},j=l((()=>(0,o.Lk)("div",{class:"title"}," Выбрано: ",-1))),P={class:"text"},Q={key:1,class:"photo-wrapper popup"},A={class:"popup-body"},S=l((()=>(0,o.Lk)("svg",{width:"22px",height:"22px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[(0,o.Lk)("path",{d:"M16 8L8 16M8.00001 8L16 16",stroke:"#000000","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"})],-1))),W=[S],F={class:"wrapper"},I=["src"],q={key:0,class:"error-modal"};function H(e,t,i,s,n,l){const S=(0,o.g2)("swiper-slide"),H=(0,o.g2)("swiper");return(0,o.uX)(),(0,o.CE)("div",a,[(0,o.Lk)("div",h,[(0,o.Lk)("div",d,[u,(0,o.Lk)("div",p,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(n.coords,(e=>((0,o.uX)(),(0,o.CE)("div",{class:(0,r.C4)(["coord",{selected:n.activeDot&&n.activeDot.id===e.id,isChoice:null!==e.choice}]),key:"coord_"+e.id,onClick:t=>l.changeDot(e),style:(0,r.Tr)({top:e.y+"px",left:e.x+"px"})},[(0,o.Lk)("div",f,[(0,o.Lk)("div",k,(0,r.v_)(e.name),1),null!==e.choice?((0,o.uX)(),(0,o.CE)("div",m," Выбрано: "+(0,r.v_)(n.choices.filter((t=>e.choice===t.id))[0].name),1)):(0,o.Q3)("",!0)])],14,v)))),128))]),(0,o.Lk)("div",g,[(0,o.Lk)("div",w,[n.total_price>0?((0,o.uX)(),(0,o.CE)("div",C," Оставшийся бюджет: "+(0,r.v_)(n.total_price-l.selectedPrice),1)):(0,o.Q3)("",!0)]),n.total_price>0?((0,o.uX)(),(0,o.CE)("button",{key:0,class:(0,r.C4)(["btn btn-primary",{disabled:n.total_price<l.selectedPrice||!n.choices.filter((e=>null!==e.choice)).length}]),onClick:t[0]||(t[0]=(...e)=>l.saveChanges&&l.saveChanges(...e))}," Сохранить ",2)):(0,o.Q3)("",!0)])]),(0,o.Lk)("div",x,[(0,o.Lk)("div",y,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(n.choices,(e=>((0,o.uX)(),(0,o.CE)("div",{class:"select-item",key:"choice_"+e.id,onClick:t=>l.selectChoice(e)},[(0,o.Lk)("div",L,[_,(0,o.Lk)("div",E,(0,r.v_)(e.name),1)]),(0,o.Lk)("div",D,[T,(0,o.Lk)("div",X,(0,r.v_)(e.price),1)]),null!==e.choice?((0,o.uX)(),(0,o.CE)("div",O,[j,(0,o.Lk)("div",P,(0,r.v_)(n.coords.filter((t=>t.choice===e.id))[0].name),1)])):(0,o.Q3)("",!0),!0===e.selected?((0,o.uX)(),(0,o.CE)("div",Q,[(0,o.Lk)("div",A,[(0,o.Lk)("div",{class:"close-popup",onClick:t[1]||(t[1]=(0,c.D$)(((...e)=>l.unselectChoices&&l.unselectChoices(...e)),["stop"]))},W),(0,o.Lk)("div",F,[(0,o.bF)(H,{"slides-per-view":1,"space-between":30},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.photos,((e,t)=>((0,o.uX)(),(0,o.Wv)(S,{key:e+t},{default:(0,o.k6)((()=>[(0,o.Lk)("img",{src:e,alt:"img"},null,8,I)])),_:2},1024)))),128))])),_:2},1024)])])])):(0,o.Q3)("",!0)],8,b)))),128))])])]),n.errorText&&n.errorText.length>0?((0,o.uX)(),(0,o.CE)("div",q,(0,r.v_)(n.errorText),1)):(0,o.Q3)("",!0)])}var K=i(9082),M={name:"HelloWorld",components:{Swiper:K.RC,SwiperSlide:K.qr},props:{msg:String},data(){return{coords:[],errorText:"",total_price:0,activeDot:null,choices:[]}},created(){this.getData(),this.choices=this.choices.map((e=>({...e,choice:null}))),this.coords=this.coords.map((e=>({...e,choice:null})))},computed:{selectedPrice(){return this.choices.reduce(((e,t)=>(t.choice&&(e+=t.price),e)),0)}},methods:{async getData(){const e=await fetch("/api/survey/",{headers:{"ngrok-skip-browser-warning":"69420"}});if(e.ok){const t=await e.json();this.setData(t)}else console.log("Error:",e.status)},setData(e){this.coords=e.coords.map((e=>({...e,selected:!1,choice:null}))),this.choices=e.choices.map((e=>({...e,selected:!1,choice:null}))),this.total_price=e.total_price},setErrorText(e){this.errorText=e,setTimeout((()=>{this.errorText=""}),2e3)},unselectChoices(){this.choices=this.choices.map((e=>({...e,selected:!1})))},changeDot(e){if(null!==e.choice)return this.choices=this.choices.map((t=>t.choice===e.id?{...t,choice:null}:t)),void(this.coords=this.coords.map((t=>e.id===t.id?{...t,choice:null}:t)));this.setActiveDot(e)},setActiveDot(e){this.activeDot=e},saveChanges(){const e=this.choices.filter((e=>null!==e.choice)),t=e.map((e=>({choice_id:e.id,coords_id:e.choice})));t&&t.length?this.saveChangesRequest({choices:t}):this.setErrorText("Выберите объекты")},saveChangesRequest(e){fetch("/api/survey/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((e=>e.json())).then((e=>{e.success?window.location=window.location.origin+"/survey/end/":e.error?this.setErrorText(e.error):this.setErrorText("Произошла ошибка сервера, попробуйте позже или перезагрузите")})).catch((()=>{this.setErrorText("Произошла ошибка сервера, попробуйте позже или перезагрузите")}))},selectChoice(e){if(null!==this.activeDot){const t=e.choice;return this.selectedPrice+e.price>this.total_price?void this.setErrorText("Вы вышли за рамки бюджета"):(this.choices=this.choices.map((t=>e.id===t.id?{...t,choice:this.activeDot.id}:t)),this.coords=this.coords.map((i=>t===i.id&&t!==this.activeDot.id?{...i,choice:null}:i.id===this.activeDot.id?{...i,choice:e.id}:i)),void(this.activeDot=null))}this.choices=this.choices.map((t=>t.id===e.id?{...t,selected:!0}:{...t,selected:!1}))}}},R=i(1241);const B=(0,R.A)(M,[["render",H],["__scopeId","data-v-7330665a"]]);var J=B,N={name:"App",components:{HelloWorld:J}};const V=(0,R.A)(N,[["render",s]]);var Y=V;const $=(0,c.Ef)(Y);$.mount("#app")}},t={};function i(c){var o=t[c];if(void 0!==o)return o.exports;var s=t[c]={exports:{}};return e[c].call(s.exports,s,s.exports,i),s.exports}i.m=e,function(){var e=[];i.O=function(t,c,o,s){if(!c){var r=1/0;for(h=0;h<e.length;h++){c=e[h][0],o=e[h][1],s=e[h][2];for(var n=!0,l=0;l<c.length;l++)(!1&s||r>=s)&&Object.keys(i.O).every((function(e){return i.O[e](c[l])}))?c.splice(l--,1):(n=!1,s<r&&(r=s));if(n){e.splice(h--,1);var a=o();void 0!==a&&(t=a)}}return t}s=s||0;for(var h=e.length;h>0&&e[h-1][2]>s;h--)e[h]=e[h-1];e[h]=[c,o,s]}}(),function(){i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,{a:t}),t}}(),function(){i.d=function(e,t){for(var c in t)i.o(t,c)&&!i.o(e,c)&&Object.defineProperty(e,c,{enumerable:!0,get:t[c]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){i.p="/"}(),function(){var e={524:0};i.O.j=function(t){return 0===e[t]};var t=function(t,c){var o,s,r=c[0],n=c[1],l=c[2],a=0;if(r.some((function(t){return 0!==e[t]}))){for(o in n)i.o(n,o)&&(i.m[o]=n[o]);if(l)var h=l(i)}for(t&&t(c);a<r.length;a++)s=r[a],i.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return i.O(h)},c=self["webpackChunkhacaton"]=self["webpackChunkhacaton"]||[];c.forEach(t.bind(null,0)),c.push=t.bind(null,c.push.bind(c))}();var c=i.O(void 0,[504],(function(){return i(426)}));c=i.O(c)})();
//# sourceMappingURL=app.f427410b.js.map